@SET_MAKE@

srcdir = @srcdir@
top_srcdir = @top_srcdir@
PACKAGE_VERSION = @PACKAGE_VERSION@

##############################################################################
# location of required programms
RM   = @RM@
MKDIR_P = @MKDIR_P@
INSTALL = @INSTALL@
INSTALL_DATA = @INSTALL_DATA@
MAKEINFO = @MAKEINFO@
TEXI2DVI = @TEXI2DVI@

# Other settings
SYMLINKS = @SYMLINKS@
LINKPATH = @LINKPATH@

datarootdir = @datarootdir@
prefix = @prefix@
info_dir = @info_dir@

##############################################################################
all: info dvc.dvi  dvc.html dvc.pdf

dvi: dvc.dvi

pdf: dvc.pdf

html: dvc.html

Makefile: $(srcdir)/Makefile.in ../config.status
	cd ..; ./config.status

ii = install-info

install: uninstall info
	$(MKDIR_P) -m 0755 $(info_dir)
	if test "x$(SYMLINKS)" = "xno" ; then                          \
          for i in `ls dvc.info* ` ; do                                \
	    echo "Installing $$i in $(info_dir)" ;                     \
            $(INSTALL_DATA) $$i $(info_dir) ;                          \
          done ;                                                       \
        else                                                           \
          if test "x$(LINKPATH)" = "x" ; then                          \
            for i in `ls dvc.info* ` ; do                              \
              echo "Linking $$i in $(info_dir)" ;                      \
              $(LN_S) `pwd`/$$i $(info_dir)/$$i ;                      \
            done ;                                                     \
          else                                                         \
            for i in `ls dvc.info* ` ; do                              \
              echo "Linking $(LINKPATH)/texinfo/$$i in $(info_dir)" ;  \
              $(LN_S) $(LINKPATH)/texinfo/$$i $(info_dir)/$$i ;        \
            done ;                                                     \
          fi ;                                                         \
        fi
	@if ($(ii) --version &&					\
	     $(ii) --version 2>&1 | sed 1q | grep -i -v debian)	\
	   >/dev/null 2>&1 ; then				\
	  $(ii) --info-dir="$(info_dir)" "$(info_dir)/dvc.info"	\
	    || : ; else : ;					\
	fi

uninstall:
	$(RM) -f $(info_dir)/dvc.info*

info: dvc.info

alldeps = $(srcdir)/dvc.texinfo dvc-version.texinfo

dvc.info: $(alldeps)
	@if test "x$(MAKEINFO)" = "x" ; then                  \
           echo "Sorry, no \`makeinfo' program available." ;   \
         else                                                 \
           $(MAKEINFO) $(srcdir)/dvc.texinfo -o $@ ;           \
         fi

dvc.html: $(alldeps)
	@if test "x$(MAKEINFO)" = "x" ; then                    \
           echo "Sorry, no \`makeinfo' program available." ;     \
         else                                                   \
           $(MAKEINFO) --html --no-split $(srcdir)/dvc.texinfo ; \
         fi

dvc.dvi: $(alldeps)
	@if test "x$(TEXI2DVI)" = "x" ; then                 \
           echo "Sorry, no \`texi2dvi' program available." ; \
         else                                                \
           $(TEXI2DVI) $(srcdir)/dvc.texinfo -o $@ ;          \
         fi

dvc.pdf: $(alldeps)
	@if test "x$(TEXI2DVI)" = "x" ; then                 \
           echo "Sorry, no \`texi2dvi' program available." ; \
         else                                                \
           $(TEXI2DVI) -p $(srcdir)/dvc.texinfo -o $@;        \
         fi

clean:
	$(RM) -f *.aux *.cp *.cps *.dvi *.pdf *.fn *.fns *.ky *.log *.pg \
	  *.toc *.tp *.vr *.vrs *.html *.info

distclean: clean
	$(RM) -f Makefile

maintainer-clean:
	$(RM) -f dvc-version.texinfo

.PHONY: pdf dvi html info clean distclean install-pkg uninstall-pkg all

dvc-version.texinfo: $(top_srcdir)/configure
	@echo Creating $@
	@( echo @set VERSION $(PACKAGE_VERSION) ; \
	   date +'@set UPDATED %F' -r $< ) > $@

.PHONY: all dvi pdf html info \
	install uninstall \
	clean distclean maintainer-clean
